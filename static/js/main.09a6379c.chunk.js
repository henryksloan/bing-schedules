(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{34:function(e,t,n){e.exports=n(77)},39:function(e,t,n){},68:function(e,t,n){},70:function(e,t,n){},72:function(e,t,n){},75:function(e,t,n){},77:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(15),s=n.n(r),c=n(79);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var u=n(6),i=n(7),l=n(9),d=n(8),h=n(10),p=n(3),m=(n(39),n(4)),b=n.n(m);n(47),n(16);b.a.initializeApp({apiKey:"AIzaSyAtkDMcmqJXjxNRvx84gYKQqssbarfkaOs",authDomain:"bing-schedules.firebaseapp.com",databaseURL:"https://bing-schedules.firebaseio.com",projectId:"bing-schedules",storageBucket:"bing-schedules.appspot.com",messagingSenderId:"249912717870"});b.a.firestore().settings({timestampsInSnapshots:!0});b.a;var g=new b.a.auth.GoogleAuthProvider,f=b.a.auth(),v=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).login=n.login.bind(Object(p.a)(Object(p.a)(n))),n.logout=n.logout.bind(Object(p.a)(Object(p.a)(n))),n}return Object(h.a)(t,e),Object(i.a)(t,[{key:"logout",value:function(){var e=this;f.signOut().then(function(){e.props.logout()})}},{key:"login",value:function(){var e=this;f.signInWithPopup(g).then(function(t){var n=t.user;e.props.login(n)})}},{key:"render",value:function(){return o.a.createElement("header",{id:"top-header"},o.a.createElement("a",{href:"/"},o.a.createElement("h1",null,"Binghamton Schedule Manager")),o.a.createElement("div",{id:"top-header-auth-button"},o.a.createElement("p",null,this.props.user?this.props.user.displayName||this.props.user.email:""),this.props.user?o.a.createElement("button",{onClick:this.logout},"Log Out"):o.a.createElement("button",{onClick:this.login},"Log In")))}}]),t}(o.a.Component),j=n(81),y=n(80),O=n(26),E=n.n(O),k=n(19),S=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).changeSubject=n.changeSubject.bind(Object(p.a)(Object(p.a)(n))),n.changeCode=n.changeCode.bind(Object(p.a)(Object(p.a)(n))),n.changeSection=n.changeSection.bind(Object(p.a)(Object(p.a)(n))),n}return Object(h.a)(t,e),Object(i.a)(t,[{key:"changeSubject",value:function(e){var t=this;this.props.updateEntry(this.props.index,{subject:e,code:null,section:null},function(){return t.code_select.focus()})}},{key:"changeCode",value:function(e){var t=this;this.props.updateEntry(this.props.index,{code:e,section:null},function(){return t.section_select.focus()})}},{key:"changeSection",value:function(e){this.props.updateEntry(this.props.index,{section:e})}},{key:"render",value:function(){var e=this,t=this.props,n=t.subject,a=t.code,r=t.section,s=this.props.getCodes(n),c=this.props.getSections(n,a);return o.a.createElement("div",null,o.a.createElement(k.a,{tabIndex:0,value:n,onChange:this.changeSubject,options:this.props.subject_options,placeholder:"Select Subject",openMenuOnFocus:!0,tabSelectsValue:!1,className:"course-select",ref:function(t){e.subject_select=t}}),o.a.createElement(k.a,{tabIndex:0,value:a,onChange:this.changeCode,options:s,placeholder:"Select Course",openMenuOnFocus:!0,tabSelectsValue:!1,isDisabled:0===s.length,className:"course-select",ref:function(t){e.code_select=t}}),o.a.createElement(k.a,{tabIndex:0,value:r,onChange:this.changeSection,options:c,placeholder:"Select Section",openMenuOnFocus:!0,tabSelectsValue:!1,isDisabled:0===c.length,className:"course-select",ref:function(t){e.section_select=t}}),o.a.createElement("img",{src:"/bing-schedules/assets/cross.png",alt:"Delete entry",style:{verticalAlign:"middle",cursor:"pointer"},width:"16",height:"16",onClick:function(){e.props.removeEntry(e.props.index)}}))}}]),t}(o.a.Component),w=(n(68),new b.a.auth.GoogleAuthProvider,b.a.auth(),function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).state={subject_options:[],entries:[{subject:null,code:null,section:null},{subject:null,code:null,section:null}]},n.getCodes=n.getCodes.bind(Object(p.a)(Object(p.a)(n))),n.getSections=n.getSections.bind(Object(p.a)(Object(p.a)(n))),n.updateEntry=n.updateEntry.bind(Object(p.a)(Object(p.a)(n))),n.addEntry=n.addEntry.bind(Object(p.a)(Object(p.a)(n))),n.removeEntry=n.removeEntry.bind(Object(p.a)(Object(p.a)(n))),n.onSubmit=n.onSubmit.bind(Object(p.a)(Object(p.a)(n))),n}return Object(h.a)(t,e),Object(i.a)(t,[{key:"componentWillReceiveProps",value:function(e){if(e.data){var t=Object.keys(e.data).reduce(function(e,t){return e.push({value:t,label:t}),e},[]);this.setState({subject_options:t})}}},{key:"getCodes",value:function(e){return e&&e.value?Object.keys(this.props.data[e.value]).reduce(function(e,t){return e.push({value:t,label:t}),e},[]):[]}},{key:"getSections",value:function(e,t){return e&&t&&e.value&&t.value?Object.keys(this.props.data[e.value][t.value]).reduce(function(e,t){return e.push({value:t,label:t}),e},[]):[]}},{key:"updateEntry",value:function(e,t,n){var a=this.state.entries;null!==a[e]&&null!==t&&(a[e]=Object.assign(a[e],t),this.setState({entries:a},n))}},{key:"addEntry",value:function(){var e=this.state.entries;e.push({subject:null,code:null,section:null}),this.setState({entries:e})}},{key:"removeEntry",value:function(e){var t=this.state.entries;t.splice(e,1),this.setState({entries:t})}},{key:"onSubmit",value:function(){for(var e=[],t=0;t<this.state.entries.length;t++)null!=this.state.entries[t].subject||null!=this.state.entries[t].code||null!=this.state.entries[t].section?null!=this.state.entries[t].subject&&null!=this.state.entries[t].code&&null!=this.state.entries[t].section?e.push(this.state.entries[t]):console.log("Please enter all fields or remove the row to continue"):console.log("All null");if(0!==e.length){var n=e.map(function(e){return{type:"course",content:{subject:e.subject.value,code:e.code.value,section:e.section.value}}});b.a.firestore().collection("groups").doc(this.props.groupId).collection("schedules").doc(this.props.user.uid).set({schedule:n})}else console.log("Please enter a course")}},{key:"render",value:function(){var e=this,t=this.state.entries.map(function(t,n){return o.a.createElement(S,{key:n,index:n,subject:t.subject,code:t.code,section:t.section,subject_options:e.state.subject_options,getCodes:e.getCodes,getSections:e.getSections,updateEntry:e.updateEntry,removeEntry:e.removeEntry})});return o.a.createElement("div",{className:"course-container"},t,o.a.createElement("div",{id:"course-container-buttons"},o.a.createElement("button",{onClick:this.addEntry},"Add another course"),o.a.createElement("button",{onClick:this.onSubmit},"Submit")))}}]),t}(o.a.Component)),C=(n(70),function(e){function t(e){var n;Object(u.a)(this,t);var a=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).days_header=a.map(function(e,t){return o.a.createElement("th",{key:t+1,className:"weekview-cell-label"},o.a.createElement("span",null,e.substr(0,3)))}),n.days_header.splice(0,0,o.a.createElement("th",{key:0,className:"weekview-cell-label"})),n.hour_min=null,n.hour_max=null,n.props.courses.forEach(function(e){var t=new Date("1/1/1970 "+e.time_start.toUpperCase().trim()).getHours();(t<n.hour_min||null==n.hour_min)&&(n.hour_min=t);var a=new Date("1/1/1970 "+e.time_end.toUpperCase().trim()).getHours();(a>n.hour_max||null==n.hour_max)&&(n.hour_max=a)});for(var r=[],s=n.hour_min;s<=n.hour_max;s++){for(var c=[],i=0;i<4;i++){var h=[];0===i&&h.push(o.a.createElement("td",{key:0,rowSpan:4,className:"weekview-cell-label"},(s+11)%12+1+(s>=12?"PM":"AM")));for(var m=0;m<a.length;m++)h.push(o.a.createElement("td",{key:a[m],className:"weekview-cell-empty"}));c.push(h)}r.push(c)}return n.row_groups_default=r,n.state={row_groups:r},n.addBlock=n.addBlock.bind(Object(p.a)(Object(p.a)(n))),n.addBlockAtTime=n.addBlockAtTime.bind(Object(p.a)(Object(p.a)(n))),n}return Object(h.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;if(this.props.courses){this.props.courses.forEach(function(t){for(var n=0;n<t.days.length;n++)e.addBlockAtTime("MTWRFSU".indexOf(t.days.charAt(n)),t.time_start,t.time_end,t.name)})}}},{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState({row_groups:this.row_groups_default}),console.log("Yo",e);e.courses.forEach(function(e){for(var n=0;n<e.days.length;n++)t.addBlockAtTime("MTWRFSU".indexOf(e.days.charAt(n)),e.time_start,e.time_end,e.name)})}},{key:"addBlock",value:function(e,t,n,a,r){var s=0===n?e+1:e,c=this.state.row_groups,u=c[t][n][s].key;c[t][n][s]=o.a.createElement("td",{rowSpan:a,style:{backgroundColor:"#ccc"},key:u},o.a.createElement("div",null,r));for(var i=1;i<a;i++){c[t+Math.floor((n+i)/4)][(n+i)%4][e+((n+i)%4===0?1:0)]=null}this.setState({row_groups:c})}},{key:"addBlockAtTime",value:function(e,t,n,a){var o=new Date("1/1/1970 "+t.toUpperCase().trim()),r={hour:o.getHours(),quarter:Math.round(o.getMinutes()/15)},s=new Date("1/1/1970 "+n.toUpperCase().trim()),c=s.getHours(),u=Math.round(s.getMinutes()/15),i=r.hour-this.hour_min;i<0&&(i=24+i);var l=r.quarter,d=0;c>r.hour&&(d+=4*(c-r.hour-1)),d+=4-r.quarter+u,this.addBlock(e,i,l,d,a)}},{key:"render",value:function(){var e=this.state.row_groups;return o.a.createElement("div",null,o.a.createElement("table",{className:"weekview-table"},o.a.createElement("thead",null,o.a.createElement("tr",null,this.days_header)),o.a.createElement("tbody",null,e.map(function(e,t){return e.map(function(e,t){return o.a.createElement("tr",{key:"row"+t},e)})}))))}}]),t}(o.a.Component)),_=(new b.a.auth.GoogleAuthProvider,b.a.auth()),A=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).state={groupId:"",user:null,group:{},data:null,schedules:[],role:null},n.getField=n.getField.bind(Object(p.a)(Object(p.a)(n))),n}return Object(h.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;_.onAuthStateChanged(function(t){if(t){console.log(t);var n=E.a.parse(e.props.location.search).groupId;e.setState({groupId:n}),b.a.firestore().collection("groups").doc(n).get().then(function(a){var o=a.data().roles;console.log(o),null==o[e.props.user.uid]&&(o[e.props.user.uid]="member",b.a.firestore().collection("groups").doc(n).update({roles:o})),e.setState({role:o[e.props.user.uid]}),"member"!==o[e.props.user.uid]||a.data().settings.members_can_view?b.a.firestore().collection("groups").doc(n).collection("schedules").get().then(function(t){var n=[];t.forEach(function(t){b.a.firestore().collection("usernames").doc(t.id).get().then(function(a){n[a.data().username]=t.data().schedule,e.setState({schedules:n})})})}).catch(function(e){console.log("Error getting document --",e)}):b.a.firestore().collection("groups").doc(n).collection("schedules").doc(t.uid).get().then(function(t){e.setState({schedules:{"My Schedule":t.data().schedule}})}).catch(function(e){console.log("Error getting document --",e)})}).catch(function(e){console.log("Error getting document --",e)})}else e.setState({groupId:"",user:null,group:{},schedules:[],role:null})});var t=this;n.e(1).then(n.t.bind(null,78,3)).then(function(e){t.setState({data:e.default})})}},{key:"getField",value:function(e,t,n,a){if(e&&t&&n){var o=this.state.data[e][t][n];return o?o[a].join(", "):""}return""}},{key:"render",value:function(){var e=this,t=[];return this.state.schedules&&Object.keys(this.state.schedules).forEach(function(n,a){var o=[];e.state.schedules[n].forEach(function(t){var n=t.content,a=e.getField(n.subject,n.code,n.section,"time").split("-");o.push({days:e.getField(n.subject,n.code,n.section,"days"),time_start:a[0].trim(),time_end:a[1].trim(),name:e.getField(n.subject,n.code,n.section,"course")})},e),t.push([n,o])},this),o.a.createElement("div",null,this.state.role,o.a.createElement(w,{data:this.state.data,user:this.props.user,groupId:this.state.groupId}),t.map(function(e,t){return o.a.createElement("div",{key:t},e[0],":",o.a.createElement(C,{courses:e[1]}))}))}}]),t}(o.a.Component),M=n(30),x=(n(72),function(e){function t(){return Object(u.a)(this,t),Object(l.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"card"},o.a.createElement("div",{className:"card-header"},this.props.title),o.a.createElement("div",{className:"card-content"},this.props.children))}}]),t}(o.a.Component)),I=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).state={title:"",groups:{}},n.onChangeTitle=n.onChangeTitle.bind(Object(p.a)(Object(p.a)(n))),n}return Object(h.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;b.a.auth().onAuthStateChanged(function(t){if(t){var n=b.a.firestore().collection("groups");[n.where("roles."+t.uid,"==","owner"),n.where("roles."+t.uid,"==","viewer"),n.where("roles."+t.uid,"==","member")].forEach(function(t){t.get().then(function(t){t.forEach(function(t){var n=e.state.groups;n[t.id]=t.data(),e.setState({groups:n})})})})}})}},{key:"createGroup",value:function(e){e&&""!==e&&this.props.user&&b.a.firestore().collection("groups").doc().set({title:e,roles:Object(M.a)({},this.props.user.uid,"owner"),settings:{members_can_view:!0}})}},{key:"onChangeTitle",value:function(e){this.setState({title:e.target.value})}},{key:"render",value:function(){var e=this;if(!this.props.user)return o.a.createElement("div",null,o.a.createElement("p",null,"Please log in to create or view schedule groups"));var t=Object.keys(this.state.groups).map(function(t,n){return o.a.createElement("a",{href:"/group/?groupId="+t,key:n},e.state.groups[t].title)});return o.a.createElement("div",null,o.a.createElement(x,{title:"Create a group"},o.a.createElement("input",{type:"text",onChange:this.onChangeTitle,value:this.state.title}),o.a.createElement("button",{onClick:function(){e.createGroup(e.state.title)}},"Create Group")),o.a.createElement(x,{title:"My groups"},t))}}]),t}(o.a.Component),N=(new b.a.auth.GoogleAuthProvider,b.a.auth()),B=function(e){function t(e){var n;return Object(u.a)(this,t),n=Object(l.a)(this,Object(d.a)(t).call(this,e)),N.onAuthStateChanged(function(e){e&&b.a.firestore().collection("usernames").doc(e.uid).get().then(function(t){null==t.data()&&b.a.firestore().collection("usernames").doc(e.uid).set({username:e.displayName})})}),n}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement(j.a,null,o.a.createElement(y.a,{exact:!0,path:"/",render:function(t){return o.a.createElement(I,Object.assign({},t,{user:e.props.user}))}}),o.a.createElement(y.a,{path:"/group",render:function(t){return o.a.createElement(A,Object.assign({},t,{user:e.props.user}))}}))}}]),t}(o.a.Component),D=(new b.a.auth.GoogleAuthProvider,b.a.auth()),T=function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(l.a)(this,Object(d.a)(t).call(this))).state={user:null},e}return Object(h.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;D.onAuthStateChanged(function(t){t?e.setState({user:t}):e.setState({user:null})})}},{key:"render",value:function(){var e=this;return o.a.createElement("div",null,o.a.createElement(v,{user:this.state.user,login:function(t){e.setState({user:t})},logout:function(){e.setState({user:null})}}),o.a.createElement(B,{user:this.state.user}))}}]),t}(o.a.Component);n(75);s.a.render(o.a.createElement(c.a,{basename:"/bing-schedules"},o.a.createElement(T,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[34,3,2]]]);
//# sourceMappingURL=main.09a6379c.chunk.js.map