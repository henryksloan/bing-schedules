(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{34:function(e,t,n){e.exports=n(79)},39:function(e,t,n){},68:function(e,t,n){},70:function(e,t,n){},72:function(e,t,n){},74:function(e,t,n){},77:function(e,t,n){},79:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(16),o=n.n(s),c=n(81);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var i=n(6),u=n(7),l=n(9),d=n(8),h=n(10),p=n(1),m=(n(39),n(4)),b=n.n(m);n(47),n(17);b.a.initializeApp({apiKey:"AIzaSyAtkDMcmqJXjxNRvx84gYKQqssbarfkaOs",authDomain:"bing-schedules.firebaseapp.com",databaseURL:"https://bing-schedules.firebaseio.com",projectId:"bing-schedules",storageBucket:"bing-schedules.appspot.com",messagingSenderId:"249912717870"});b.a.firestore().settings({timestampsInSnapshots:!0});b.a;var v=new b.a.auth.GoogleAuthProvider,f=b.a.auth(),g=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).login=n.login.bind(Object(p.a)(Object(p.a)(n))),n.logout=n.logout.bind(Object(p.a)(Object(p.a)(n))),n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"logout",value:function(){var e=this;f.signOut().then(function(){e.props.logout()})}},{key:"login",value:function(){var e=this;v.setCustomParameters({prompt:"select_account"}),f.signInWithPopup(v).then(function(t){var n=t.user;e.props.login(n)})}},{key:"render",value:function(){return r.a.createElement("header",{id:"top-header"},r.a.createElement("a",{href:"/bing-schedules/"},r.a.createElement("h1",null,"Binghamton Schedule Manager")),r.a.createElement("div",{id:"top-header-auth-button"},r.a.createElement("p",null,this.props.user?this.props.user.displayName||this.props.user.email:""),this.props.user?r.a.createElement("button",{className:"button gray",onClick:this.logout},"Log Out"):r.a.createElement("button",{className:"button gray",onClick:this.login},"Log In")))}}]),t}(r.a.Component),y=n(83),j=n(82),E=n(26),O=n.n(E),k=n(14),S=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).changeSubject=n.changeSubject.bind(Object(p.a)(Object(p.a)(n))),n.changeCode=n.changeCode.bind(Object(p.a)(Object(p.a)(n))),n.changeSection=n.changeSection.bind(Object(p.a)(Object(p.a)(n))),n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"changeSubject",value:function(e){var t=this;this.props.updateEntry(this.props.index,{subject:e,code:null,section:null},function(){return t.code_select.focus()})}},{key:"changeCode",value:function(e){var t=this;this.props.updateEntry(this.props.index,{code:e,section:null},function(){return t.section_select.focus()})}},{key:"changeSection",value:function(e){var t=this;this.props.updateEntry(this.props.index,{section:0===e.length?null:e},function(){return 0===e.length?null:t.props.focusNextEntry()})}},{key:"focusSubject",value:function(){this.subject_select.focus()}},{key:"render",value:function(){var e=this,t=this.props,n=t.subject,a=t.code,s=t.section,o=this.props.getCodes(n),c=this.props.getSections(n,a);return r.a.createElement("div",null,r.a.createElement(k.c,{tabIndex:0,value:n,onChange:this.changeSubject,options:this.props.subject_options,placeholder:"Select Subject",openMenuOnFocus:!0,tabSelectsValue:!1,className:"course-select",classNamePrefix:"react-select",filterOption:Object(k.b)({matchFrom:"start"}),ref:function(t){e.subject_select=t}}),r.a.createElement(k.c,{tabIndex:0,value:a,onChange:this.changeCode,options:o,placeholder:"Select Course",openMenuOnFocus:!0,tabSelectsValue:!1,isDisabled:0===o.length,className:"course-select",classNamePrefix:"react-select",filterOption:Object(k.b)({matchFrom:"start"}),ref:function(t){e.code_select=t}}),r.a.createElement(k.c,{tabIndex:0,value:s,onChange:this.changeSection,options:c,placeholder:"Select Section",openMenuOnFocus:!0,tabSelectsValue:!1,isDisabled:0===c.length,className:"course-select",classNamePrefix:"react-select",filterOption:Object(k.b)({matchFrom:"start"}),components:{Option:function(e){return r.a.createElement("div",null,r.a.createElement(k.a.Option,e,e.children,r.a.createElement("span",{className:e.data.time.indexOf(", ")>-1?"multiple":""},e.data.time.split(", ").map(function(e,t){return[e,r.a.createElement("br",{key:t})]}))))}},isOptionDisabled:function(e){return e.already_entered},ref:function(t){e.section_select=t}}),r.a.createElement("img",{src:"/bing-schedules/assets/cross.png",alt:"Delete entry",style:{verticalAlign:"middle",cursor:"pointer"},width:"16",height:"16",onClick:function(){e.props.removeEntry(e.props.index)}}))}}]),t}(r.a.Component),_=(n(68),new b.a.auth.GoogleAuthProvider,b.a.auth(),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).state={subject_options:[],entries:[{subject:null,code:null,section:null},{subject:null,code:null,section:null}],selector_refs:[]},n.getCodes=n.getCodes.bind(Object(p.a)(Object(p.a)(n))),n.getSections=n.getSections.bind(Object(p.a)(Object(p.a)(n))),n.updateEntry=n.updateEntry.bind(Object(p.a)(Object(p.a)(n))),n.getActivities=n.getActivities.bind(Object(p.a)(Object(p.a)(n))),n.addEntry=n.addEntry.bind(Object(p.a)(Object(p.a)(n))),n.addFilledEntry=n.addFilledEntry.bind(Object(p.a)(Object(p.a)(n))),n.removeEntry=n.removeEntry.bind(Object(p.a)(Object(p.a)(n))),n.onSubmit=n.onSubmit.bind(Object(p.a)(Object(p.a)(n))),n.focusNextEntry=n.focusNextEntry.bind(Object(p.a)(Object(p.a)(n))),n.shouldFindActivities=n.shouldFindActivities.bind(Object(p.a)(Object(p.a)(n))),n.renderActivityButtons=n.renderActivityButtons.bind(Object(p.a)(Object(p.a)(n))),n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentWillReceiveProps",value:function(e){if(e.data){var t=Object.keys(e.data).reduce(function(e,t){return e.push({value:t,label:t}),e},[]);this.setState({subject_options:t})}}},{key:"getCodes",value:function(e){return e&&e.value?Object.keys(this.props.data[e.value]).reduce(function(e,t){return e.push({value:t,label:t}),e},[]):[]}},{key:"getSections",value:function(e,t){var n=this;if(e&&t&&e.value&&t.value){var a=Object.keys(this.props.data[e.value][t.value]).reduce(function(a,r){var s=!1;for(var o in n.state.entries)if(n.state.entries[o].subject&&n.state.entries[o].code&&n.state.entries[o].section&&n.state.entries[o].subject.value===e.value&&n.state.entries[o].code.value===t.value&&n.state.entries[o].section.value===r){s=!0;break}var c=n.props.data[e.value][t.value][r].type[0];return a[c]||(a[c]=[]),a[c].push({value:r,label:r,time:n.props.getTime(e.value,t.value,r),already_entered:s}),a},{});return Object.entries(a).reduce(function(e,t){return e.push({label:t[0],options:t[1]}),e},[])}return[]}},{key:"updateEntry",value:function(e,t,n){var a=this.state.entries;null!==a[e]&&null!==t&&(a[e]=Object.assign(a[e],t),this.setState({entries:a},n))}},{key:"getActivities",value:function(e,t,n){var a=this;return e&&t&&n&&e.value&&t.value&&n.value?Object.keys(this.props.data[e.value][t.value]).filter(function(n){var r=a.props.data[e.value][t.value][n];return"Activity"===r.type[0]||"Discussion"===r.type[0]}):[]}},{key:"addEntry",value:function(e,t,n){var a=this.state.entries;a.push({subject:null,code:null,section:null}),this.setState({entries:a})}},{key:"addFilledEntry",value:function(e,t,n,a){var r=this.state.entries;r.splice(a,0,{subject:e,code:t,section:n}),this.setState({entries:r})}},{key:"removeEntry",value:function(e){var t=this.state.entries;t.splice(e,1),this.setState({entries:t})}},{key:"onSubmit",value:function(){for(var e=[],t=0;t<this.state.entries.length;t++)null!=this.state.entries[t].subject||null!=this.state.entries[t].code||null!=this.state.entries[t].section?null!=this.state.entries[t].subject&&null!=this.state.entries[t].code&&null!=this.state.entries[t].section?e.push(this.state.entries[t]):console.log("Please enter all fields or remove the row to continue"):console.log("All null");if(0!==e.length){var n=e.map(function(e){return{type:"course",content:{subject:e.subject.value,code:e.code.value,section:e.section.value}}});b.a.firestore().collection("groups").doc(this.props.groupId).collection("schedules").doc(this.props.user.uid).set({schedule:n})}else console.log("Please enter a course")}},{key:"focusNextEntry",value:function(e){this.selector_refs.length<=e+1?(this.addEntry(),this.to_focus=e+1):this.selector_refs[e+1].focusSubject()}},{key:"shouldFindActivities",value:function(e){for(var t=0;t<this.state.entries.length;t++)if(this.state.entries[t].subject&&this.state.entries[t].code&&this.state.entries[e].subject&&this.state.entries[e].code){var n=this.state.entries[e];if(n.subject&&n.code&&n.section){console.log(n);var a=this.props.data[n.subject.value][n.code.value][n.section.value];if("Discussion"===a.type[0]||"Activity"===a.type[0])return!1}if(t!==e&&this.state.entries[t].subject.value===n.subject.value&&this.state.entries[t].code.value===n.code.value)return!1}return!0}},{key:"renderActivityButtons",value:function(e){var t=this;if(this.shouldFindActivities(e)){var n=this.state.entries[e];if(n){var a=this.getActivities(n.subject,n.code,n.section).reduce(function(a,s,o){return a.push(r.a.createElement("button",{key:o,className:"button gray",onClick:function(){t.addFilledEntry(n.subject,n.code,{value:s,label:s},e+1),t.to_focus=e+2}},s," | ",t.props.getTime(n.subject.value,n.code.value,s))),a},[]);return a.length>0?r.a.createElement("div",null,"Add activities:"," ",a):void 0}}}},{key:"render",value:function(){var e=this;this.selector_refs=[];var t=this.state.entries.map(function(t,n){return r.a.createElement("div",{key:n},r.a.createElement(S,{index:n,subject:t.subject,code:t.code,section:t.section,subject_options:e.state.subject_options,getCodes:e.getCodes,getSections:e.getSections,updateEntry:e.updateEntry,removeEntry:e.removeEntry,focusNextEntry:function(){e.focusNextEntry(n)},ref:function(t){e.selector_refs[n]=t,e.to_focus===n&&(t.focusSubject(),e.to_focus=null)}}),e.renderActivityButtons(n))});return r.a.createElement("div",{className:"course-container"},t,r.a.createElement("div",{id:"course-container-buttons"},r.a.createElement("button",{onClick:this.addEntry},"Add another course"),r.a.createElement("button",{onClick:this.onSubmit},"Submit")))}}]),t}(r.a.Component)),w=(n(70),function(e){function t(e){var n;Object(i.a)(this,t);var a=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).days_header=a.map(function(e,t){return r.a.createElement("th",{key:t+1,className:"weekview-cell-label"},r.a.createElement("span",null,e.substr(0,3)))}),n.days_header.splice(0,0,r.a.createElement("th",{key:0,className:"weekview-cell-label"})),n.hour_min=null,n.hour_max=null,n.props.courses.forEach(function(e){var t=new Date("1/1/1970 "+e.time_start.toUpperCase().trim()).getHours();(t<n.hour_min||null==n.hour_min)&&(n.hour_min=t);var a=new Date("1/1/1970 "+e.time_end.toUpperCase().trim()).getHours();(a>n.hour_max||null==n.hour_max)&&(n.hour_max=a)}),n.props.startHour&&n.props.startHour<=n.hour_min&&(n.hour_min=n.props.startHour),n.props.endHour&&n.props.endHour>=n.hour_max&&(n.hour_max=n.props.endHour);for(var s=[],o=n.hour_min;o<=n.hour_max;o++){for(var c=[],u=0;u<4;u++){var h=[];0===u&&h.push(r.a.createElement("td",{key:0,rowSpan:4,className:"weekview-cell-label"},(o+11)%12+1+(o>=12?"PM":"AM")));for(var m=0;m<a.length;m++)h.push(r.a.createElement("td",{key:a[m],className:"weekview-cell-empty"}));c.push(h)}s.push(c)}return n.row_groups_default=s,n.state={row_groups:s},n.addBlock=n.addBlock.bind(Object(p.a)(Object(p.a)(n))),n.addBlockAtTime=n.addBlockAtTime.bind(Object(p.a)(Object(p.a)(n))),n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;if(this.props.courses){this.props.courses.forEach(function(t){for(var n=0;n<t.days.length;n++)e.addBlockAtTime("MTWRFSU".indexOf(t.days.charAt(n)),t.time_start,t.time_end,t.name)})}}},{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState({row_groups:this.row_groups_default});e.courses.forEach(function(e){for(var n=0;n<e.days.length;n++)t.addBlockAtTime("MTWRFSU".indexOf(e.days.charAt(n)),e.time_start,e.time_end,e.name)})}},{key:"addBlock",value:function(e,t,n,a,s){var o=0===n?e+1:e,c=this.state.row_groups,i=c[t][n][o].key;c[t][n][o]=r.a.createElement("td",{rowSpan:a,style:{backgroundColor:"#ccc"},key:i},r.a.createElement("div",null,s));for(var u=1;u<a;u++){c[t+Math.floor((n+u)/4)][(n+u)%4][e+((n+u)%4===0?1:0)]=null}this.setState({row_groups:c})}},{key:"addBlockAtTime",value:function(e,t,n,a){var r=new Date("1/1/1970 "+t.toUpperCase().trim()),s={hour:r.getHours(),quarter:Math.round(r.getMinutes()/15)},o=new Date("1/1/1970 "+n.toUpperCase().trim()),c=o.getHours(),i=Math.round(o.getMinutes()/15),u=s.hour-this.hour_min;u<0&&(u=24+u);var l=s.quarter,d=0;c>s.hour&&(d+=4*(c-s.hour-1)),d+=4-s.quarter+i,this.addBlock(e,u,l,d,a)}},{key:"render",value:function(){var e=this.state.row_groups;return r.a.createElement("div",null,r.a.createElement("table",{className:"weekview-table"},r.a.createElement("colgroup",null,r.a.createElement("col",{style:{width:"50px"}}),r.a.createElement("col",{style:{width:"100px"}}),r.a.createElement("col",{style:{width:"100px"}}),r.a.createElement("col",{style:{width:"100px"}}),r.a.createElement("col",{style:{width:"100px"}}),r.a.createElement("col",{style:{width:"100px"}}),r.a.createElement("col",{style:{width:"100px"}}),r.a.createElement("col",{style:{width:"100px"}})),r.a.createElement("thead",null,r.a.createElement("tr",{className:"weekview-title"},r.a.createElement("td",{colSpan:8},this.props.title)),r.a.createElement("tr",null,this.days_header)),r.a.createElement("tbody",null,e.map(function(e,t){return e.map(function(e,t){return r.a.createElement("tr",{key:"row"+t},e)})}))))}}]),t}(r.a.Component)),C=(new b.a.auth.GoogleAuthProvider,b.a.auth()),x=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).state={groupId:"",user:null,group:{},data:null,schedules:[],role:null},n.getField=n.getField.bind(Object(p.a)(Object(p.a)(n))),n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;C.onAuthStateChanged(function(t){if(t){console.log(t);var n=O.a.parse(e.props.location.search).groupId;e.setState({groupId:n}),b.a.firestore().collection("groups").doc(n).get().then(function(a){var r=a.data().roles;null==r[e.props.user.uid]&&(r[e.props.user.uid]="member",b.a.firestore().collection("groups").doc(n).update({roles:r})),e.setState({role:r[e.props.user.uid]}),"member"!==r[e.props.user.uid]||a.data().settings.members_can_view?b.a.firestore().collection("groups").doc(n).collection("schedules").get().then(function(t){var n=[];t.forEach(function(t){b.a.firestore().collection("usernames").doc(t.id).get().then(function(a){n[a.data().username]=t.data().schedule,e.setState({schedules:n})})})}).catch(function(e){console.log("Error getting document --",e)}):b.a.firestore().collection("groups").doc(n).collection("schedules").doc(t.uid).get().then(function(t){e.setState({schedules:{"My Schedule":t.data().schedule}})}).catch(function(e){console.log("Error getting document --",e)})}).catch(function(e){console.log("Error getting document --",e)})}else e.setState({groupId:"",user:null,group:{},schedules:[],role:null})});var t=this;n.e(1).then(n.t.bind(null,80,3)).then(function(e){t.setState({data:e.default})})}},{key:"getField",value:function(e,t,n,a){if(e&&t&&n){var r=this.state.data[e][t][n];if(r){if(r[a].constructor===Array)return r[a];var s=[];return s.push(r[a]),s}return""}return""}},{key:"render",value:function(){var e=this,t=[];return this.state.schedules&&Object.keys(this.state.schedules).forEach(function(n,a){var r=[];e.state.schedules[n].forEach(function(t){var n=t.content,a=e.getField(n.subject,n.code,n.section,"time"),s=e.getField(n.subject,n.code,n.section,"days"),o=e.getField(n.subject,n.code,n.section,"course"),c=[];if(a.constructor===Array)for(var i=0;i<a.length;i++)c=a[i].split("-"),r.push({days:s[i],time_start:c[0].trim(),time_end:c[1].trim(),name:o[i]});else c=a.split("-"),r.push({days:s[i],time_start:c[0].trim(),time_end:c[1].trim(),name:o[i]})},e),t.push([n,r])},this),r.a.createElement("div",null,this.state.role,r.a.createElement(_,{data:this.state.data,user:this.props.user,groupId:this.state.groupId,getTime:function(t,n,a){return e.getField(t,n,a,"time").join(", ")}}),t.map(function(e,t){return r.a.createElement("div",{key:t},r.a.createElement(w,{title:e[0],courses:e[1]}))}))}}]),t}(r.a.Component),A=n(30),N=(n(72),function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header"},this.props.title),r.a.createElement("div",{className:"card-content"},this.props.children))}}]),t}(r.a.Component)),F=(n(74),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).state={title:"",groups:{}},n.onChangeTitle=n.onChangeTitle.bind(Object(p.a)(Object(p.a)(n))),n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;b.a.auth().onAuthStateChanged(function(t){if(t){var n=b.a.firestore().collection("groups");[n.where("roles."+t.uid,"==","owner"),n.where("roles."+t.uid,"==","viewer"),n.where("roles."+t.uid,"==","member")].forEach(function(t){t.get().then(function(t){t.forEach(function(t){var n=e.state.groups;n[t.id]=t.data(),e.setState({groups:n})})})})}})}},{key:"createGroup",value:function(e){e&&""!==e&&this.props.user&&b.a.firestore().collection("groups").doc().set({title:e,roles:Object(A.a)({},this.props.user.uid,"owner"),settings:{members_can_view:!0}})}},{key:"onChangeTitle",value:function(e){this.setState({title:e.target.value})}},{key:"render",value:function(){var e=this;if(!this.props.user)return r.a.createElement("div",null,r.a.createElement("p",null,"Please log in to create or view schedule groups"));var t=Object.keys(this.state.groups).map(function(t,n){return r.a.createElement("li",{key:n},r.a.createElement("a",{href:"/bing-schedules/group/?groupId="+t},e.state.groups[t].title))});return r.a.createElement("div",{id:"landing-container"},r.a.createElement("div",{id:"create-group-card"},r.a.createElement(N,{title:"Create a group"},r.a.createElement("label",{id:"name-label"},r.a.createElement("p",null,"Name"),r.a.createElement("input",{type:"text",onChange:this.onChangeTitle,placeholder:"Enter a group name",value:this.state.title})),r.a.createElement("br",null),r.a.createElement("label",{id:"checkbox-label"},r.a.createElement("p",null,"Members can view all schedules"),r.a.createElement("input",{type:"checkbox",onChange:function(){return 0},value:!1})),r.a.createElement("button",{id:"create-group-button",className:"button green large",onClick:function(){e.createGroup(e.state.title)}},"Create Group"))),r.a.createElement("div",{id:"my-groups-card"},r.a.createElement(N,{title:"My groups"},r.a.createElement("ul",null,t))),r.a.createElement("div",{id:"my-schedules-card"},r.a.createElement(N,{title:"My schedules"})))}}]),t}(r.a.Component)),M=(new b.a.auth.GoogleAuthProvider,b.a.auth()),I=function(e){function t(e){var n;return Object(i.a)(this,t),n=Object(l.a)(this,Object(d.a)(t).call(this,e)),M.onAuthStateChanged(function(e){e&&b.a.firestore().collection("usernames").doc(e.uid).get().then(function(t){null==t.data()&&b.a.firestore().collection("usernames").doc(e.uid).set({username:e.displayName})})}),n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(y.a,null,r.a.createElement(j.a,{exact:!0,path:"/",render:function(t){return r.a.createElement(F,Object.assign({},t,{user:e.props.user}))}}),r.a.createElement(j.a,{path:"/group",render:function(t){return r.a.createElement(x,Object.assign({},t,{user:e.props.user}))}}))}}]),t}(r.a.Component),B=(new b.a.auth.GoogleAuthProvider,b.a.auth()),D=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(l.a)(this,Object(d.a)(t).call(this))).state={user:null},e}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;B.onAuthStateChanged(function(t){t?e.setState({user:t}):e.setState({user:null})})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{id:"app"},r.a.createElement(g,{user:this.state.user,login:function(t){e.setState({user:t})},logout:function(){e.setState({user:null})}}),r.a.createElement(I,{user:this.state.user}))}}]),t}(r.a.Component);n(77);o.a.render(r.a.createElement(c.a,{basename:"/bing-schedules"},r.a.createElement(D,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[34,3,2]]]);
//# sourceMappingURL=main.bdfeaa3d.chunk.js.map